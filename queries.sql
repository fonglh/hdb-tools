# Get latest resale transactions for each postal code where the remaining lease is >= 85 years.
select * from resale_transactions inner join (select postal_code, max(registration_date) as latest_transaction from resale_transactions group by postal_code) as max_reg_date ON resale_transactions.postal_code=max_reg_date.postal_code WHERE registration_date=latest_transactions and remaining_lease >= 85;

# Get flat info for the most recent transaction in each block where the remaining lease is >= 85 years.
select blocks.postal_code, blocks.address, blocks.town_name, latest_transactions.resale_price, floor_area, floor_min, floor_max, model, flat_type, remaining_lease, latest_transaction from blocks inner join (select resale_transactions.postal_code, resale_price, floor_area, floor_min, floor_max, model, flat_type, remaining_lease, latest_transaction from resale_transactions inner join (select postal_code, max(registration_date) as latest_transaction from resale_transactions group by postal_code) as max_reg_date ON resale_transactions.postal_code=max_reg_date.postal_code WHERE registration_date=latest_transaction and remaining_lease >= 85) as latest_transactions ON blocks.postal_code=latest_transactions.postal_code;
